import { Meta } from '@storybook/blocks';
import { tokens } from '@adsmagic/tokens';

<Meta title="Refer√™ncias/Acessibilidade" />

# üéØ Guia de Acessibilidade - WCAG 2.1 AA

## Vis√£o Geral

O Design System Adsmagic implementa **acessibilidade WCAG 2.1 N√≠vel AA** como padr√£o obrigat√≥rio. Este guia documenta os padr√µes, ferramentas e processos para garantir que todos os componentes atendam aos requisitos de acessibilidade.

## üèÜ N√≠veis de Conformidade WCAG

### N√≠vel A (B√°sico)
- Requisitos m√≠nimos de acessibilidade
- Barreiras cr√≠ticas removidas

### N√≠vel AA (Padr√£o Adsmagic)
- Requisitos intermedi√°rios
- Maior acessibilidade para usu√°rios com defici√™ncias
- **Padr√£o obrigat√≥rio** para todos os componentes

### N√≠vel AAA (Avan√ßado)
- Requisitos mais rigorosos
- Aplicado apenas em casos espec√≠ficos (ex.: governo, educa√ß√£o)

## üîß Ferramentas e Testes

### Auditoria Autom√°tica
- **axe-core/playwright**: Testes automatizados em CI/CD
- **Storybook Accessibility Addon**: Verifica√ß√£o visual durante desenvolvimento
- **Lighthouse Accessibility**: Auditoria integrada ao CI

### Testes Manuais
- Navega√ß√£o por teclado (Tab, Shift+Tab, Enter, Space, Escape)
- Leitores de tela (NVDA, JAWS, VoiceOver)
- Ferramentas de contraste (Color Contrast Analyzer)
- Testes com usu√°rios reais

## üé® Padr√µes de Implementa√ß√£o

### Componentes Interativos

#### Bot√µes
```tsx
// ‚úÖ Correto - Bot√£o com texto acess√≠vel
<Button onClick={handleClick}>
  Salvar altera√ß√µes
</Button>

// ‚úÖ Correto - Bot√£o com √≠cone e aria-label
<Button onClick={handleClick} aria-label="Fechar modal">
  <XIcon />
</Button>

// ‚ùå Incorreto - Bot√£o s√≥ com √≠cone sem texto acess√≠vel
<Button onClick={handleClick}>
  <XIcon />
</Button>
```

#### Estados Loading
```tsx
// ‚úÖ Correto - Estado loading com aria-disabled
<Button loading loadingText="Salvando...">
  Salvar
</Button>
```

### Formul√°rios e Entradas

#### Labels e Descri√ß√µes
```tsx
// ‚úÖ Correto - Label associado via htmlFor
<label htmlFor="email">Endere√ßo de email</label>
<input id="email" type="email" />

// ‚úÖ Correto - aria-labelledby para labels complexos
<div id="email-label">Endere√ßo de email <span className="required">*</span></div>
<input aria-labelledby="email-label" type="email" />
```

#### Estados de Erro
```tsx
// ‚úÖ Correto - aria-describedby para mensagens de erro
<input
  aria-describedby="email-error"
  aria-invalid={hasError}
/>
<div id="email-error" role="alert">
  Endere√ßo de email inv√°lido
</div>
```

### Navega√ß√£o e Estruturas

#### Cabe√ßalhos Sem√¢nticos
```tsx
// ‚úÖ Correto - Hierarquia de cabe√ßalhos
<h1>T√≠tulo da p√°gina</h1>
  <h2>Se√ß√£o principal</h2>
    <h3>Subse√ß√£o</h3>
  <h2>Outra se√ß√£o</h2>
```

#### Tabelas de Dados
```tsx
// ‚úÖ Correto - Tabela com roles e scope
<table role="table" aria-label="Produtos em estoque">
  <thead>
    <tr role="row">
      <th scope="col" role="columnheader">Produto</th>
      <th scope="col" role="columnheader">Quantidade</th>
    </tr>
  </thead>
  <tbody>
    <tr role="row">
      <td role="cell">Notebook</td>
      <td role="cell">15</td>
    </tr>
  </tbody>
</table>
```

#### Dropdowns e Selects
```tsx
// ‚úÖ Correto - Combobox acess√≠vel
<div>
  <label id="status-label">Status do projeto</label>
  <button
    aria-haspopup="listbox"
    aria-expanded="false"
    aria-labelledby="status-label"
  >
    Selecionar status
  </button>
  <ul role="listbox" aria-labelledby="status-label">
    <li role="option" aria-selected="true">Ativo</li>
    <li role="option" aria-selected="false">Pausado</li>
  </ul>
</div>
```

## üé® Design Acess√≠vel

### Contraste de Cores

#### Requisitos WCAG AA
- **Texto normal**: Contraste m√≠nimo 4.5:1
- **Texto grande** (18pt+ ou 14pt+ negrito): Contraste m√≠nimo 3:1
- **Componentes interativos**: Contraste m√≠nimo 3:1

#### Tokens de Cor Acess√≠veis
```tsx
// ‚úÖ Cores com bom contraste
tokens.colors.slate900  // Texto principal
tokens.colors.primary600 // Links e bot√µes
tokens.colors.success600 // Estados positivos
tokens.colors.danger600  // Estados de erro
```

### Foco Vis√≠vel

#### Indicadores de Foco
```css
/* ‚úÖ Foco vis√≠vel e acess√≠vel */
.focus-visible {
  outline: 2px solid {tokens.colors.primary600};
  outline-offset: 2px;
}

/* ‚ùå Foco removido completamente */
.no-focus {
  outline: none;
}
```

### Espa√ßamento e Toque

#### √Åreas de Toque M√≠nimas
- **44x44px** para elementos interativos (WCAG)
- **48x48px** recomendado para melhor usabilidade

## üîç Testes Automatizados

### Configura√ß√£o axe-core
```typescript
import AxeBuilder from '@axe-core/playwright';

const accessibilityScanResults = await new AxeBuilder({ page })
  .withTags(['wcag2a', 'wcag2aa', 'wcag21a', 'wcag21aa'])
  .analyze();

// Verificar viola√ß√µes cr√≠ticas
const criticalViolations = accessibilityScanResults.violations
  .filter(v => v.impact === 'critical');

expect(criticalViolations).toHaveLength(0);
```

### Regras Importantes Verificadas

#### color-contrast
- Contraste adequado entre texto e fundo
- Verificado automaticamente em todos os componentes

#### button-name
- Bot√µes devem ter nome acess√≠vel
- Via texto interno ou aria-label

#### image-alt
- Imagens devem ter texto alternativo
- Ou aria-hidden se decorativas

#### heading-order
- Hierarquia de cabe√ßalhos correta
- Sem saltos (h1 ‚Üí h3 ‚ùå)

#### link-name
- Links devem ter nome descritivo
- Evitar "clique aqui", "aqui", etc.

## üöÄ Checklist de Desenvolvimento

### Antes de Commitar
- [ ] Executar `npm run test:accessibility`
- [ ] Verificar contraste com ferramenta autom√°tica
- [ ] Testar navega√ß√£o por teclado
- [ ] Validar com leitor de tela

### Revis√£o de Pull Request
- [ ] Acessibilidade testada automaticamente
- [ ] Nenhum aumento significativo de viola√ß√µes
- [ ] Componentes novos incluem testes de acessibilidade
- [ ] Documenta√ß√£o atualizada com considera√ß√µes de acessibilidade

### Checklist de Componente
- [ ] Suporte completo a navega√ß√£o por teclado
- [ ] Estados comunicados via ARIA
- [ ] Contraste adequado (4.5:1 m√≠nimo)
- [ ] Texto alternativo para imagens
- [ ] Labels apropriados para formul√°rios
- [ ] Foco vis√≠vel e l√≥gico
- [ ] Sem armadilhas de foco

## üìä M√©tricas e Monitoramento

### KPIs de Acessibilidade
- **Pontua√ß√£o Lighthouse**: ‚â• 90/100
- **Viola√ß√µes cr√≠ticas**: 0
- **Viola√ß√µes s√©rias**: ‚â§ 5 por p√°gina
- **Contraste**: 100% compliant

### Relat√≥rios Automatizados
```typescript
// Exemplo de relat√≥rio gerado automaticamente
{
  "score": 95,
  "grade": "A",
  "violations": {
    "critical": 0,
    "serious": 2,
    "moderate": 8,
    "minor": 15
  },
  "tests": {
    "passed": 28,
    "failed": 2,
    "incomplete": 1
  }
}
```

## üõ†Ô∏è Ferramentas de Desenvolvimento

### Extens√µes Recomendadas
- **axe DevTools**: An√°lise em tempo real
- **WAVE Evaluation Tool**: Avalia√ß√£o visual
- **Color Contrast Analyzer**: Verifica√ß√£o de contraste
- **NVDA Screen Reader**: Testes com leitores de tela

### Scripts NPM
```json
{
  "scripts": {
    "accessibility:audit": "axe http://localhost:3000",
    "accessibility:test": "playwright test tests/accessibility.spec.ts",
    "accessibility:storybook": "npm run test:storybook -- --addon=@storybook/addon-a11y"
  }
}
```

## üìö Recursos Adicionais

### Documenta√ß√£o Oficial
- [WCAG 2.1 Guidelines](https://www.w3.org/TR/WCAG21/)
- [WAI-ARIA Authoring Practices](https://www.w3.org/WAI/ARIA/apg/)
- [axe-core Rule Descriptions](https://github.com/dequelabs/axe-core/blob/master/doc/rule-descriptions.md)

### Ferramentas Online
- [WebAIM Contrast Checker](https://webaim.org/resources/contrastchecker/)
- [WAVE Web Accessibility Tool](https://wave.webaim.org/)
- [Stark for Sketch/Figma](https://www.getstark.co/)

### Comunidades
- [Web Accessibility Initiative](https://www.w3.org/WAI/)
- [A11y Project](https://www.a11yproject.com/)
- [CSS-Tricks Accessibility](https://css-tricks.com/tag/accessibility/)

## üéØ Compromisso com Acessibilidade

A acessibilidade n√£o √© um "extra" - √© um **requisito fundamental** do Design System Adsmagic. Todos os componentes devem ser acess√≠veis por padr√£o, garantindo que produtos digitais sejam inclusivos e atendam √†s necessidades de todos os usu√°rios.

**"Acessibilidade √© democracia digital"** - Torben Nielsen